<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (version 1.7.0_51) on Tue Dec 20 11:03:22 BRST 2016 -->
<title>JournalExecutor</title>
<meta name="date" content="2016-12-20">
<link rel="stylesheet" type="text/css" href="../../../../../stylesheet.css" title="Style">
</head>
<body>
<script type="text/javascript"><!--
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="JournalExecutor";
    }
//-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar_top">
<!--   -->
</a><a href="#skip-navbar_top" title="Skip navigation links"></a><a name="navbar_top_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/JournalExecutor.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../index-files/index-1.html">Index</a></li>
<li><a href="../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li>Prev Class</li>
<li><a href="../../../../../com/dsf/dbxtract/cdc/journal/JournalHandler.html" title="interface in com.dsf.dbxtract.cdc.journal"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../index.html?com/dsf/dbxtract/cdc/journal/JournalExecutor.html" target="_top">Frames</a></li>
<li><a href="JournalExecutor.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field_summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field_detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">com.dsf.dbxtract.cdc.journal</div>
<h2 title="Class JournalExecutor" class="title">Class JournalExecutor</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li>java.lang.Object</li>
<li>
<ul class="inheritance">
<li>com.dsf.dbxtract.cdc.journal.JournalExecutor</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<dl>
<dt>All Implemented Interfaces:</dt>
<dd>java.lang.Runnable</dd>
</dl>
<hr>
<br>
<pre>public class <span class="strong">JournalExecutor</span>
extends java.lang.Object
implements java.lang.Runnable</pre>
<div class="block">This class is specialized on journal-based change-data-capture.</div>
<dl><dt><span class="strong">Author:</span></dt>
  <dd>fabio de santi</dd></dl>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- =========== FIELD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="field_summary">
<!--   -->
</a>
<h3>Field Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Field Summary table, listing fields, and an explanation">
<caption><span>Fields</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Field and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private java.lang.String</code></td>
<td class="colLast"><code><strong><a href="../../../../../com/dsf/dbxtract/cdc/journal/JournalExecutor.html#agentName">agentName</a></strong></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private java.util.Map&lt;<a href="../../../../../com/dsf/dbxtract/cdc/Source.html" title="class in com.dsf.dbxtract.cdc">Source</a>,org.apache.commons.dbcp2.BasicDataSource&gt;</code></td>
<td class="colLast"><code><strong><a href="../../../../../com/dsf/dbxtract/cdc/journal/JournalExecutor.html#dataSources">dataSources</a></strong></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private <a href="../../../../../com/dsf/dbxtract/cdc/journal/JournalHandler.html" title="interface in com.dsf.dbxtract.cdc.journal">JournalHandler</a></code></td>
<td class="colLast"><code><strong><a href="../../../../../com/dsf/dbxtract/cdc/journal/JournalExecutor.html#handler">handler</a></strong></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private java.util.List&lt;java.lang.String&gt;</code></td>
<td class="colLast"><code><strong><a href="../../../../../com/dsf/dbxtract/cdc/journal/JournalExecutor.html#journalColumns">journalColumns</a></strong></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private static org.apache.log4j.Logger</code></td>
<td class="colLast"><code><strong><a href="../../../../../com/dsf/dbxtract/cdc/journal/JournalExecutor.html#logger">logger</a></strong></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private java.lang.String</code></td>
<td class="colLast"><code><strong><a href="../../../../../com/dsf/dbxtract/cdc/journal/JournalExecutor.html#logPrefix">logPrefix</a></strong></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private java.lang.String</code></td>
<td class="colLast"><code><strong><a href="../../../../../com/dsf/dbxtract/cdc/journal/JournalExecutor.html#prefix">prefix</a></strong></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private <a href="../../../../../com/dsf/dbxtract/cdc/Source.html" title="class in com.dsf.dbxtract.cdc">Source</a></code></td>
<td class="colLast"><code><strong><a href="../../../../../com/dsf/dbxtract/cdc/journal/JournalExecutor.html#source">source</a></strong></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private <a href="../../../../../com/dsf/dbxtract/cdc/mon/Statistics.html" title="class in com.dsf.dbxtract.cdc.mon">Statistics</a></code></td>
<td class="colLast"><code><strong><a href="../../../../../com/dsf/dbxtract/cdc/journal/JournalExecutor.html#statistics">statistics</a></strong></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private java.lang.String</code></td>
<td class="colLast"><code><strong><a href="../../../../../com/dsf/dbxtract/cdc/journal/JournalExecutor.html#zookeeper">zookeeper</a></strong></code>&nbsp;</td>
</tr>
</table>
</li>
</ul>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor_summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Constructor Summary table, listing constructors, and an explanation">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colOne" scope="col">Constructor and Description</th>
</tr>
<tr class="altColor">
<td class="colOne"><code><strong><a href="../../../../../com/dsf/dbxtract/cdc/journal/JournalExecutor.html#JournalExecutor(java.lang.String, java.lang.String, com.dsf.dbxtract.cdc.journal.JournalHandler, com.dsf.dbxtract.cdc.Source)">JournalExecutor</a></strong>(java.lang.String&nbsp;agentName,
               java.lang.String&nbsp;zookeeper,
               <a href="../../../../../com/dsf/dbxtract/cdc/journal/JournalHandler.html" title="interface in com.dsf.dbxtract.cdc.journal">JournalHandler</a>&nbsp;handler,
               <a href="../../../../../com/dsf/dbxtract/cdc/Source.html" title="class in com.dsf.dbxtract.cdc">Source</a>&nbsp;source)</code>&nbsp;</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method_summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span>Methods</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private void</code></td>
<td class="colLast"><code><strong><a href="../../../../../com/dsf/dbxtract/cdc/journal/JournalExecutor.html#copyResultsetToMap(java.sql.ResultSet, java.util.List)">copyResultsetToMap</a></strong>(java.sql.ResultSet&nbsp;rs,
                  java.util.List&lt;java.util.Map&lt;java.lang.String,java.lang.Object&gt;&gt;&nbsp;result)</code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private void</code></td>
<td class="colLast"><code><strong><a href="../../../../../com/dsf/dbxtract/cdc/journal/JournalExecutor.html#deleteFromJournal(java.sql.Connection, java.util.List)">deleteFromJournal</a></strong>(java.sql.Connection&nbsp;conn,
                 java.util.List&lt;java.util.Map&lt;java.lang.String,java.lang.Object&gt;&gt;&nbsp;rows)</code>
<div class="block">Removes imported references from journal table.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private void</code></td>
<td class="colLast"><code><strong><a href="../../../../../com/dsf/dbxtract/cdc/journal/JournalExecutor.html#fillParameters(java.util.Map, java.lang.String, com.dsf.utils.sql.NamedParameterStatement)">fillParameters</a></strong>(java.util.Map&lt;java.lang.String,java.lang.Object&gt;&nbsp;map,
              java.lang.String&nbsp;query,
              <a href="../../../../../com/dsf/utils/sql/NamedParameterStatement.html" title="class in com.dsf.utils.sql">NamedParameterStatement</a>&nbsp;ps)</code>
<div class="block">Fill named parameter in a query from a Map<ColumnName and Value>.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private java.lang.String[]</code></td>
<td class="colLast"><code><strong><a href="../../../../../com/dsf/dbxtract/cdc/journal/JournalExecutor.html#getColumnNamesFromResultSet(java.sql.ResultSet)">getColumnNamesFromResultSet</a></strong>(java.sql.ResultSet&nbsp;rs)</code>
<div class="block">Retrieve column names from a resultset</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private java.sql.Connection</code></td>
<td class="colLast"><code><strong><a href="../../../../../com/dsf/dbxtract/cdc/journal/JournalExecutor.html#getConnection()">getConnection</a></strong>()</code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private java.util.List&lt;java.util.Map&lt;java.lang.String,java.lang.Object&gt;&gt;</code></td>
<td class="colLast"><code><strong><a href="../../../../../com/dsf/dbxtract/cdc/journal/JournalExecutor.html#getJournalKeys(org.apache.curator.framework.CuratorFramework, java.sql.Connection)">getJournalKeys</a></strong>(org.apache.curator.framework.CuratorFramework&nbsp;client,
              java.sql.Connection&nbsp;conn)</code>
<div class="block">Gets reference data from journal table.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private java.lang.Long</code></td>
<td class="colLast"><code><strong><a href="../../../../../com/dsf/dbxtract/cdc/journal/JournalExecutor.html#getLastWindowId(org.apache.curator.framework.CuratorFramework)">getLastWindowId</a></strong>(org.apache.curator.framework.CuratorFramework&nbsp;client)</code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private java.lang.String</code></td>
<td class="colLast"><code><strong><a href="../../../../../com/dsf/dbxtract/cdc/journal/JournalExecutor.html#getPrefix()">getPrefix</a></strong>()</code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private void</code></td>
<td class="colLast"><code><strong><a href="../../../../../com/dsf/dbxtract/cdc/journal/JournalExecutor.html#markLastLoaded(org.apache.curator.framework.CuratorFramework, java.util.List)">markLastLoaded</a></strong>(org.apache.curator.framework.CuratorFramework&nbsp;client,
              java.util.List&lt;java.util.Map&lt;java.lang.String,java.lang.Object&gt;&gt;&nbsp;rows)</code>
<div class="block">Memorizes the last imported window_id from journal table</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../../com/dsf/dbxtract/cdc/journal/JournalExecutor.html#run()">run</a></strong>()</code>
<div class="block">Gets from journal table any update, executes the query to retrieve data,
 publishes to somewhere and removes imported data from journal.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private void</code></td>
<td class="colLast"><code><strong><a href="../../../../../com/dsf/dbxtract/cdc/journal/JournalExecutor.html#selectAndPublish(java.sql.Connection, java.util.List)">selectAndPublish</a></strong>(java.sql.Connection&nbsp;conn,
                java.util.List&lt;java.util.Map&lt;java.lang.String,java.lang.Object&gt;&gt;&nbsp;rows)</code>
<div class="block">Retrieves updated data and publishes somewhere.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods_inherited_from_class_java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.Object</h3>
<code>clone, equals, finalize, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ FIELD DETAIL =========== -->
<ul class="blockList">
<li class="blockList"><a name="field_detail">
<!--   -->
</a>
<h3>Field Detail</h3>
<a name="logger">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>logger</h4>
<pre>private static final&nbsp;org.apache.log4j.Logger logger</pre>
</li>
</ul>
<a name="dataSources">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>dataSources</h4>
<pre>private&nbsp;java.util.Map&lt;<a href="../../../../../com/dsf/dbxtract/cdc/Source.html" title="class in com.dsf.dbxtract.cdc">Source</a>,org.apache.commons.dbcp2.BasicDataSource&gt; dataSources</pre>
</li>
</ul>
<a name="statistics">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>statistics</h4>
<pre>private&nbsp;<a href="../../../../../com/dsf/dbxtract/cdc/mon/Statistics.html" title="class in com.dsf.dbxtract.cdc.mon">Statistics</a> statistics</pre>
</li>
</ul>
<a name="zookeeper">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>zookeeper</h4>
<pre>private&nbsp;java.lang.String zookeeper</pre>
</li>
</ul>
<a name="handler">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>handler</h4>
<pre>private&nbsp;<a href="../../../../../com/dsf/dbxtract/cdc/journal/JournalHandler.html" title="interface in com.dsf.dbxtract.cdc.journal">JournalHandler</a> handler</pre>
</li>
</ul>
<a name="source">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>source</h4>
<pre>private&nbsp;<a href="../../../../../com/dsf/dbxtract/cdc/Source.html" title="class in com.dsf.dbxtract.cdc">Source</a> source</pre>
</li>
</ul>
<a name="agentName">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>agentName</h4>
<pre>private&nbsp;java.lang.String agentName</pre>
</li>
</ul>
<a name="prefix">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>prefix</h4>
<pre>private&nbsp;java.lang.String prefix</pre>
</li>
</ul>
<a name="logPrefix">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>logPrefix</h4>
<pre>private&nbsp;java.lang.String logPrefix</pre>
</li>
</ul>
<a name="journalColumns">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>journalColumns</h4>
<pre>private&nbsp;java.util.List&lt;java.lang.String&gt; journalColumns</pre>
</li>
</ul>
</li>
</ul>
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor_detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a name="JournalExecutor(java.lang.String, java.lang.String, com.dsf.dbxtract.cdc.journal.JournalHandler, com.dsf.dbxtract.cdc.Source)">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>JournalExecutor</h4>
<pre>public&nbsp;JournalExecutor(java.lang.String&nbsp;agentName,
               java.lang.String&nbsp;zookeeper,
               <a href="../../../../../com/dsf/dbxtract/cdc/journal/JournalHandler.html" title="interface in com.dsf.dbxtract.cdc.journal">JournalHandler</a>&nbsp;handler,
               <a href="../../../../../com/dsf/dbxtract/cdc/Source.html" title="class in com.dsf.dbxtract.cdc">Source</a>&nbsp;source)</pre>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>agentName</code> - cdc agent's assigned name</dd><dd><code>zookeeper</code> - connection string to ZooKeeper server</dd><dd><code>handler</code> - <a href="../../../../../com/dsf/dbxtract/cdc/journal/JournalHandler.html" title="interface in com.dsf.dbxtract.cdc.journal"><code>JournalHandler</code></a></dd><dd><code>source</code> - <a href="../../../../../com/dsf/dbxtract/cdc/Source.html" title="class in com.dsf.dbxtract.cdc"><code>Source</code></a></dd></dl>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method_detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="getConnection()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getConnection</h4>
<pre>private&nbsp;java.sql.Connection&nbsp;getConnection()
                                   throws java.sql.SQLException</pre>
<dl><dt><span class="strong">Throws:</span></dt>
<dd><code>java.sql.SQLException</code></dd></dl>
</li>
</ul>
<a name="getPrefix()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getPrefix</h4>
<pre>private&nbsp;java.lang.String&nbsp;getPrefix()</pre>
</li>
</ul>
<a name="getLastWindowId(org.apache.curator.framework.CuratorFramework)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getLastWindowId</h4>
<pre>private&nbsp;java.lang.Long&nbsp;getLastWindowId(org.apache.curator.framework.CuratorFramework&nbsp;client)
                                throws <a href="../../../../../com/dsf/dbxtract/cdc/ConfigurationException.html" title="class in com.dsf.dbxtract.cdc">ConfigurationException</a></pre>
<dl><dt><span class="strong">Throws:</span></dt>
<dd><code><a href="../../../../../com/dsf/dbxtract/cdc/ConfigurationException.html" title="class in com.dsf.dbxtract.cdc">ConfigurationException</a></code></dd></dl>
</li>
</ul>
<a name="getJournalKeys(org.apache.curator.framework.CuratorFramework, java.sql.Connection)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getJournalKeys</h4>
<pre>private&nbsp;java.util.List&lt;java.util.Map&lt;java.lang.String,java.lang.Object&gt;&gt;&nbsp;getJournalKeys(org.apache.curator.framework.CuratorFramework&nbsp;client,
                                                                              java.sql.Connection&nbsp;conn)
                                                                                 throws java.sql.SQLException,
                                                                                        <a href="../../../../../com/dsf/dbxtract/cdc/ConfigurationException.html" title="class in com.dsf.dbxtract.cdc">ConfigurationException</a></pre>
<div class="block">Gets reference data from journal table.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>client</code> - </dd><dd><code>conn</code> - </dd>
<dt><span class="strong">Returns:</span></dt><dd>a Map list with column names and values</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>java.sql.SQLException</code></dd>
<dd><code><a href="../../../../../com/dsf/dbxtract/cdc/ConfigurationException.html" title="class in com.dsf.dbxtract.cdc">ConfigurationException</a></code></dd></dl>
</li>
</ul>
<a name="copyResultsetToMap(java.sql.ResultSet, java.util.List)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>copyResultsetToMap</h4>
<pre>private&nbsp;void&nbsp;copyResultsetToMap(java.sql.ResultSet&nbsp;rs,
                      java.util.List&lt;java.util.Map&lt;java.lang.String,java.lang.Object&gt;&gt;&nbsp;result)
                         throws java.sql.SQLException</pre>
<dl><dt><span class="strong">Throws:</span></dt>
<dd><code>java.sql.SQLException</code></dd></dl>
</li>
</ul>
<a name="selectAndPublish(java.sql.Connection, java.util.List)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>selectAndPublish</h4>
<pre>private&nbsp;void&nbsp;selectAndPublish(java.sql.Connection&nbsp;conn,
                    java.util.List&lt;java.util.Map&lt;java.lang.String,java.lang.Object&gt;&gt;&nbsp;rows)
                       throws java.sql.SQLException,
                              java.io.IOException,
                              <a href="../../../../../com/dsf/dbxtract/cdc/PublishException.html" title="class in com.dsf.dbxtract.cdc">PublishException</a></pre>
<div class="block">Retrieves updated data and publishes somewhere.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>conn</code> - </dd><dd><code>rows</code> - </dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>java.sql.SQLException</code></dd>
<dd><code>java.io.IOException</code></dd>
<dd><code><a href="../../../../../com/dsf/dbxtract/cdc/PublishException.html" title="class in com.dsf.dbxtract.cdc">PublishException</a></code></dd>
<dd><code>java.lang.Exception</code></dd></dl>
</li>
</ul>
<a name="getColumnNamesFromResultSet(java.sql.ResultSet)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getColumnNamesFromResultSet</h4>
<pre>private&nbsp;java.lang.String[]&nbsp;getColumnNamesFromResultSet(java.sql.ResultSet&nbsp;rs)
                                                throws java.sql.SQLException</pre>
<div class="block">Retrieve column names from a resultset</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>rs</code> - query result set</dd>
<dt><span class="strong">Returns:</span></dt><dd>array of column names</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>java.sql.SQLException</code></dd></dl>
</li>
</ul>
<a name="fillParameters(java.util.Map, java.lang.String, com.dsf.utils.sql.NamedParameterStatement)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>fillParameters</h4>
<pre>private&nbsp;void&nbsp;fillParameters(java.util.Map&lt;java.lang.String,java.lang.Object&gt;&nbsp;map,
                  java.lang.String&nbsp;query,
                  <a href="../../../../../com/dsf/utils/sql/NamedParameterStatement.html" title="class in com.dsf.utils.sql">NamedParameterStatement</a>&nbsp;ps)
                     throws java.sql.SQLException</pre>
<div class="block">Fill named parameter in a query from a Map<ColumnName and Value>.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>map</code> - parameters map</dd><dd><code>query</code> - query statement</dd><dd><code>ps</code> - a named parameter statement</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>java.sql.SQLException</code></dd></dl>
</li>
</ul>
<a name="deleteFromJournal(java.sql.Connection, java.util.List)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>deleteFromJournal</h4>
<pre>private&nbsp;void&nbsp;deleteFromJournal(java.sql.Connection&nbsp;conn,
                     java.util.List&lt;java.util.Map&lt;java.lang.String,java.lang.Object&gt;&gt;&nbsp;rows)
                        throws java.sql.SQLException</pre>
<div class="block">Removes imported references from journal table.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>conn</code> - </dd><dd><code>rows</code> - </dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>java.sql.SQLException</code></dd></dl>
</li>
</ul>
<a name="markLastLoaded(org.apache.curator.framework.CuratorFramework, java.util.List)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>markLastLoaded</h4>
<pre>private&nbsp;void&nbsp;markLastLoaded(org.apache.curator.framework.CuratorFramework&nbsp;client,
                  java.util.List&lt;java.util.Map&lt;java.lang.String,java.lang.Object&gt;&gt;&nbsp;rows)</pre>
<div class="block">Memorizes the last imported window_id from journal table</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>rows</code> - </dd></dl>
</li>
</ul>
<a name="run()">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>run</h4>
<pre>public&nbsp;void&nbsp;run()</pre>
<div class="block">Gets from journal table any update, executes the query to retrieve data,
 publishes to somewhere and removes imported data from journal.

 This routine is controlled by ZooKeeper that ensures only one node will
 try to import a specific table's data at time.</div>
<dl>
<dt><strong>Specified by:</strong></dt>
<dd><code>run</code>&nbsp;in interface&nbsp;<code>java.lang.Runnable</code></dd>
</dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar_bottom">
<!--   -->
</a><a href="#skip-navbar_bottom" title="Skip navigation links"></a><a name="navbar_bottom_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/JournalExecutor.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../index-files/index-1.html">Index</a></li>
<li><a href="../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li>Prev Class</li>
<li><a href="../../../../../com/dsf/dbxtract/cdc/journal/JournalHandler.html" title="interface in com.dsf.dbxtract.cdc.journal"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../index.html?com/dsf/dbxtract/cdc/journal/JournalExecutor.html" target="_top">Frames</a></li>
<li><a href="JournalExecutor.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field_summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field_detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</body>
</html>
